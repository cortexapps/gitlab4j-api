package org.gitlab4j.api;

import org.gitlab4j.api.models.VulnerabilityFinding;
import org.gitlab4j.api.models.VulnerabilityFindingFilter;

import java.util.List;

public class VulnerabilityFindingsApi extends AbstractApi {

    public VulnerabilityFindingsApi(GitLabApi gitLabApi) {
        super(gitLabApi);
    }

    public List<VulnerabilityFinding> getVulnerabilityFindings(Object projectId) throws GitLabApiException {
        return getVulnerabilityFindings(projectId, null, getDefaultPerPage()).all();
    }

    public Pager<VulnerabilityFinding> getVulnerabilityFindings(Object projectIdOrPath, VulnerabilityFindingFilter filter, int itemsPerPage) throws GitLabApiException {
        GitLabApiForm formData = (filter != null ? filter.getQueryParams() : new GitLabApiForm());

        return (new Pager<VulnerabilityFinding>(this, VulnerabilityFinding.class, itemsPerPage, formData.asMap(), "projects",
                getProjectIdOrPath(projectIdOrPath), "vulnerability_findings"));
    }
}
